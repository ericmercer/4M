From 6207cd9de01bbad921f852cf33efbaebb496f6dc Mon Sep 17 00:00:00 2001
From: Nick Vrvilo <nv4@rice.edu>
Date: Fri, 2 Dec 2011 16:03:08 -0700
Subject: [PATCH] Patching some build problems on linux

---
 GEM/src/gem_driver.c        |    2 ++
 mcapi-1.0/Makefile          |    7 -------
 mcapi-1.0/examples/leader.c |    3 ++-
 3 files changed, 4 insertions(+), 8 deletions(-)
 create mode 100644 GEM/bin/.gitignore
 create mode 100644 mcapi-1.0/bin/.gitignore

diff --git a/GEM/bin/.gitignore b/GEM/bin/.gitignore
new file mode 100644
index 0000000..e69de29
diff --git a/GEM/src/gem_driver.c b/GEM/src/gem_driver.c
index f1a760a..f29f5d4 100644
--- a/GEM/src/gem_driver.c
+++ b/GEM/src/gem_driver.c
@@ -2,6 +2,8 @@
 #include <stdio.h>
 #include <signal.h>
 #include <unistd.h>
+#include <sys/types.h>
+#include <sys/wait.h>
 
 #include "gem_driver.h"
 #include "gem_config.h"
diff --git a/mcapi-1.0/Makefile b/mcapi-1.0/Makefile
index 0e2ffd9..f8b6b12 100644
--- a/mcapi-1.0/Makefile
+++ b/mcapi-1.0/Makefile
@@ -32,13 +32,6 @@ clean:
 	make -C $(GEM_PATH) clean
 	rm -f bin/*
 
-
-test: all
-	./selfsend
-	./twosends
-	./tophscen
-	./nonblocking
-
 ordertest: $(CFILES) $(EXAMPLES)/ordertest.c
 	$(CC) $(CFLAGS) $(INCS) $^ -o $(BIN)/$@
 
diff --git a/mcapi-1.0/bin/.gitignore b/mcapi-1.0/bin/.gitignore
new file mode 100644
index 0000000..e69de29
diff --git a/mcapi-1.0/examples/leader.c b/mcapi-1.0/examples/leader.c
index d48f1c0..f007046 100644
--- a/mcapi-1.0/examples/leader.c
+++ b/mcapi-1.0/examples/leader.c
@@ -2,6 +2,7 @@
 #include <stdlib.h>
 #include <string.h>
 #include <unistd.h>
+#include <time.h>
 
 #include "gem.h"
 #include "mcapi.h"
@@ -82,7 +83,7 @@ void action(void *param) {
 
             if ((myVal == 0) && (INT(recvBuf) == 1)) {
                 active = 0;
-                printf("[%d] is going inactive.\n", tid);
+                printf("[%ld] is going inactive.\n", tid);
             }
         } else {
             mcapi_msg_recv(me, recvBuf, bufSize, &recvSize, &status);
-- 
1.7.4

